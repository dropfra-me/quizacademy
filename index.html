<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multipurpose Quiz Application</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .stats {
            display: flex;
            justify-content: space-around;
            background: #f8f9fa;
            padding: 25px;
            border-bottom: 1px solid #dee2e6;
        }

        .stat {
            text-align: center;
        }

        .stat-number {
            font-size: 2.2rem;
            font-weight: bold;
            color: #3498db;
        }

        .stat-label {
            color: #6c757d;
            font-size: 0.9rem;
            margin-top: 5px;
        }

        .course-selection {
            padding: 40px;
            text-align: center;
        }

        .course-selection h2 {
            color: #2c3e50;
            margin-bottom: 30px;
            font-size: 1.8rem;
        }

        .course-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .course-card {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 15px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .course-card:hover {
            border-color: #3498db;
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(52, 152, 219, 0.15);
        }

        .course-card.selected {
            border-color: #3498db;
            background: #e3f2fd;
        }

        .course-title {
            font-size: 1.3rem;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .course-modules {
            color: #6c757d;
            font-size: 0.9rem;
        }

        .module-selection {
            padding: 40px;
            display: none;
        }

        .module-selection h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.8rem;
        }

        .selected-course-info {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .module-options {
            display: grid;
            gap: 15px;
            margin-bottom: 30px;
        }

        .module-option {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
        }

        .module-option:hover {
            border-color: #3498db;
            background: #e3f2fd;
        }

        .module-option input[type="checkbox"] {
            margin-right: 15px;
            transform: scale(1.2);
        }

        .all-modules {
            background: #27ae60;
            color: white;
            border: none;
        }

        .all-modules:hover {
            background: #219a52;
        }

        .control-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover {
            background: #2980b9;
        }

        .btn-success {
            background: #27ae60;
            color: white;
        }

        .btn-success:hover {
            background: #219a52;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        button:disabled {
            background: #95a5a6;
            cursor: not-allowed;
        }

        .quiz-area {
            padding: 40px;
            min-height: 400px;
        }

        .question {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 25px;
            border-left: 5px solid #3498db;
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .question-meta {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .question-number {
            background: #3498db;
            color: white;
            padding: 8px 16px;
            border-radius: 25px;
            font-weight: bold;
        }

        .category-tag {
            background: #e3f2fd;
            color: #1976d2;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .question-text {
            font-size: 1.3rem;
            margin-bottom: 25px;
            line-height: 1.6;
            color: #2c3e50;
        }

        .options {
            display: grid;
            gap: 12px;
        }

        .option {
            background: white;
            border: 2px solid #dee2e6;
            padding: 18px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .option:hover {
            border-color: #3498db;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.1);
        }

        .option.selected {
            border-color: #3498db;
            background: #e3f2fd;
        }

        .option.correct {
            border-color: #27ae60;
            background: #d4edda;
        }

        .option.incorrect {
            border-color: #e74c3c;
            background: #f8d7da;
        }

        .input-answer {
            width: 100%;
            padding: 18px;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            font-size: 1.1rem;
        }

        .explanation {
            margin-top: 25px;
            padding: 25px;
            background: #e8f5e8;
            border-radius: 10px;
            border-left: 4px solid #27ae60;
        }

        .quiz-navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            gap: 15px;
        }

        .results {
            text-align: center;
            padding: 50px;
        }

        .score {
            font-size: 4rem;
            font-weight: bold;
            color: #27ae60;
            margin-bottom: 25px;
        }

        .welcome {
            text-align: center;
            padding: 50px;
            color: #6c757d;
        }

        .welcome h2 {
            margin-bottom: 25px;
            color: #2c3e50;
            font-size: 2rem;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #6c757d;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 20px;
            border-radius: 10px;
            margin: 20px;
            border-left: 4px solid #dc3545;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéì Quiz Academy</h1>
            <p>Master your knowledge across multiple courses</p>
        </div>

        <div class="stats">
            <div class="stat">
                <div class="stat-number" id="totalQuestions">0</div>
                <div class="stat-label">Total Questions</div>
            </div>
            <div class="stat">
                <div class="stat-number" id="currentQuestion">0</div>
                <div class="stat-label">Current</div>
            </div>
            <div class="stat">
                <div class="stat-number" id="correctAnswers">0</div>
                <div class="stat-label">Correct</div>
            </div>
            <div class="stat">
                <div class="stat-number" id="scorePercentage">0%</div>
                <div class="stat-label">Score</div>
            </div>
        </div>

        <div class="welcome" id="welcomeScreen">
            <h2>Welcome to Quiz Academy</h2>
            <p>Select a course and modules to test your knowledge</p>
            <div class="loading" id="loadingIndicator">
                <div class="spinner"></div>
                <p>Loading courses...</p>
            </div>
        </div>

        <div class="course-selection" id="courseSelection" style="display: none;">
            <h2>Select a Course</h2>
            <div class="course-grid" id="courseGrid"></div>
            <div class="control-buttons">
                <button class="btn-primary" id="selectCourseBtn" disabled>Select Course</button>
            </div>
        </div>

        <div class="module-selection" id="moduleSelection">
            <h2>Select Modules</h2>
            <div class="selected-course-info" id="selectedCourseInfo"></div>
            <div class="module-options" id="moduleOptions"></div>
            <div class="control-buttons">
                <button class="btn-secondary" id="backToCourses">‚Üê Back to Courses</button>
                <button class="btn-success" id="startQuizBtn" disabled>Start Quiz</button>
            </div>
        </div>

        <div class="quiz-area" id="quizArea" style="display: none;">
            <div class="question">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number" id="questionNum">Question 1</span>
                        <span class="category-tag" id="questionCategory">Category</span>
                    </div>
                </div>
                <div class="question-text" id="questionText"></div>
                <div id="questionOptions"></div>
                <div class="explanation" id="explanation" style="display: none;"></div>
            </div>

            <div class="quiz-navigation">
                <button class="btn-secondary" id="prevQuestion" disabled>‚Üê Previous</button>
                <button class="btn-primary" id="checkAnswer">Check Answer</button>
                <button class="btn-primary" id="nextQuestion" disabled>Next ‚Üí</button>
            </div>
        </div>

        <div class="results" id="resultsScreen" style="display: none;">
            <div class="score" id="finalScore">85%</div>
            <h2>Quiz Complete!</h2>
            <p id="resultsText">Great job! Keep up the excellent work.</p>
            <div class="control-buttons" style="margin-top: 30px;">
                <button class="btn-success" id="restartQuiz">Take Quiz Again</button>
                <button class="btn-secondary" id="newQuiz">Select New Course</button>
            </div>
        </div>
    </div>

    <script>
        class QuizApp {
            constructor() {
                this.courses = {};
                this.selectedCourse = null;
                this.selectedModules = [];
                this.questions = [];
                this.currentQuestionIndex = 0;
                this.userAnswers = [];
                this.correctCount = 0;
                this.quizStarted = false;
                
                this.initializeEventListeners();
                this.loadConfiguration();
            }

            initializeEventListeners() {
                document.getElementById('selectCourseBtn').addEventListener('click', () => this.proceedToModuleSelection());
                document.getElementById('backToCourses').addEventListener('click', () => this.showCourseSelection());
                document.getElementById('startQuizBtn').addEventListener('click', () => this.startQuiz());
                document.getElementById('prevQuestion').addEventListener('click', () => this.previousQuestion());
                document.getElementById('nextQuestion').addEventListener('click', () => this.nextQuestion());
                document.getElementById('checkAnswer').addEventListener('click', () => this.checkAnswer());
                document.getElementById('restartQuiz').addEventListener('click', () => this.restartCurrentQuiz());
                document.getElementById('newQuiz').addEventListener('click', () => this.showCourseSelection());
            }

            async loadConfiguration() {
                try {
                    const response = await fetch('quizes.yml');
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    const yamlContent = await response.text();
                    const config = jsyaml.load(yamlContent);
                    
                    this.courses = config.courses || {};
                    this.displayCourses();
                } catch (error) {
                    this.showError('Failed to load configuration. Make sure quizes.yml exists and is properly formatted.');
                    console.error('Configuration loading error:', error);
                }
            }

            showError(message) {
                document.getElementById('loadingIndicator').innerHTML = `
                    <div class="error">
                        <strong>Error:</strong> ${message}
                    </div>
                `;
            }

            displayCourses() {
                const courseGrid = document.getElementById('courseGrid');
                courseGrid.innerHTML = '';

                Object.entries(this.courses).forEach(([courseName, courseData]) => {
                    const courseCard = document.createElement('div');
                    courseCard.className = 'course-card';
                    courseCard.onclick = () => this.selectCourse(courseName, courseCard);
                    
                    const moduleCount = Object.keys(courseData.modules || {}).length;
                    courseCard.innerHTML = `
                        <div class="course-title">${courseName}</div>
                        <div class="course-modules">${moduleCount} modules available</div>
                    `;
                    
                    courseGrid.appendChild(courseCard);
                });

                document.getElementById('welcomeScreen').style.display = 'none';
                document.getElementById('courseSelection').style.display = 'block';
            }

            selectCourse(courseName, cardElement) {
                // Clear previous selections
                document.querySelectorAll('.course-card').forEach(card => {
                    card.classList.remove('selected');
                });
                
                // Select current course
                cardElement.classList.add('selected');
                this.selectedCourse = courseName;
                document.getElementById('selectCourseBtn').disabled = false;
            }

            proceedToModuleSelection() {
                if (!this.selectedCourse) return;

                const courseData = this.courses[this.selectedCourse];
                const modules = courseData.modules || {};

                // Update course info
                document.getElementById('selectedCourseInfo').innerHTML = `
                    <strong>Selected Course:</strong> ${this.selectedCourse}<br>
                    <small>Choose which modules to include in your quiz</small>
                `;

                // Create module options
                const moduleOptions = document.getElementById('moduleOptions');
                moduleOptions.innerHTML = '';

                // Add "All Modules" option
                const allModulesOption = document.createElement('div');
                allModulesOption.className = 'module-option all-modules';
                allModulesOption.innerHTML = `
                    <input type="checkbox" id="allModules">
                    <label for="allModules" style="cursor: pointer;">All Modules (${Object.keys(modules).length} modules)</label>
                `;
                allModulesOption.onclick = () => this.toggleAllModules();
                moduleOptions.appendChild(allModulesOption);

                // Add individual module options
                Object.entries(modules).forEach(([moduleName, modulePath]) => {
                    const moduleOption = document.createElement('div');
                    moduleOption.className = 'module-option';
                    const moduleId = `module_${moduleName.replace(/\s+/g, '_')}`;
                    moduleOption.innerHTML = `
                        <input type="checkbox" id="${moduleId}" data-path="${modulePath}">
                        <label for="${moduleId}" style="cursor: pointer;">${moduleName}</label>
                    `;
                    moduleOption.onclick = () => this.toggleModule(moduleId);
                    moduleOptions.appendChild(moduleOption);
                });

                document.getElementById('courseSelection').style.display = 'none';
                document.getElementById('moduleSelection').style.display = 'block';
                this.updateStartButtonState();
            }

            toggleAllModules() {
                const allModulesCheckbox = document.getElementById('allModules');
                const moduleCheckboxes = document.querySelectorAll('#moduleOptions input[type="checkbox"]:not(#allModules)');
                
                allModulesCheckbox.checked = !allModulesCheckbox.checked;
                moduleCheckboxes.forEach(checkbox => {
                    checkbox.checked = allModulesCheckbox.checked;
                });
                
                this.updateStartButtonState();
            }

            toggleModule(moduleId) {
                const checkbox = document.getElementById(moduleId);
                checkbox.checked = !checkbox.checked;
                
                // Update "All Modules" checkbox state
                const allCheckboxes = document.querySelectorAll('#moduleOptions input[type="checkbox"]:not(#allModules)');
                const checkedCheckboxes = document.querySelectorAll('#moduleOptions input[type="checkbox"]:not(#allModules):checked');
                const allModulesCheckbox = document.getElementById('allModules');
                
                allModulesCheckbox.checked = allCheckboxes.length === checkedCheckboxes.length;
                
                this.updateStartButtonState();
            }

            updateStartButtonState() {
                const checkedModules = document.querySelectorAll('#moduleOptions input[type="checkbox"]:checked');
                document.getElementById('startQuizBtn').disabled = checkedModules.length === 0;
            }

            async startQuiz() {
                const checkedModules = document.querySelectorAll('#moduleOptions input[type="checkbox"]:not(#allModules):checked');
                
                if (checkedModules.length === 0) {
                    alert('Please select at least one module!');
                    return;
                }

                // Show loading
                document.getElementById('moduleSelection').style.display = 'none';
                document.getElementById('welcomeScreen').style.display = 'block';
                document.getElementById('loadingIndicator').innerHTML = `
                    <div class="spinner"></div>
                    <p>Loading questions...</p>
                `;

                try {
                    this.questions = [];
                    
                    // Load questions from selected modules
                    for (const checkbox of checkedModules) {
                        const modulePath = checkbox.getAttribute('data-path');
                        await this.loadQuestionFile(modulePath);
                    }

                    if (this.questions.length === 0) {
                        throw new Error('No questions found in selected modules');
                    }

                    // Shuffle questions
                    this.shuffleArray(this.questions);

                    // Initialize quiz
                    this.quizStarted = true;
                    this.currentQuestionIndex = 0;
                    this.userAnswers = new Array(this.questions.length).fill(null);
                    this.correctCount = 0;

                    document.getElementById('welcomeScreen').style.display = 'none';
                    document.getElementById('quizArea').style.display = 'block';

                    this.displayQuestion();
                    this.updateStats();
                } catch (error) {
                    this.showError(`Failed to load questions: ${error.message}`);
                }
            }

            async loadQuestionFile(path) {
                try {
                    const response = await fetch(path);
                    if (!response.ok) {
                        throw new Error(`Failed to load ${path}: ${response.status}`);
                    }
                    const yamlContent = await response.text();
                    const data = jsyaml.load(yamlContent);
                    
                    if (data.questions && Array.isArray(data.questions)) {
                        this.questions.push(...data.questions);
                    }
                } catch (error) {
                    console.error(`Error loading ${path}:`, error);
                    // Continue loading other files even if one fails
                }
            }

            shuffleArray(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
            }

            displayQuestion() {
                const question = this.questions[this.currentQuestionIndex];
                
                document.getElementById('questionNum').textContent = `Question ${this.currentQuestionIndex + 1}`;
                document.getElementById('questionCategory').textContent = question.category || 'General';
                document.getElementById('questionText').textContent = question.question;
                document.getElementById('explanation').style.display = 'none';

                this.renderQuestionOptions(question);
                this.updateNavigationButtons();
            }

            renderQuestionOptions(question) {
                const container = document.getElementById('questionOptions');
                container.innerHTML = '';

                if (question.type === 'multiple_choice') {
                    const optionsDiv = document.createElement('div');
                    optionsDiv.className = 'options';
                    
                    question.options.forEach((option, index) => {
                        const optionDiv = document.createElement('div');
                        optionDiv.className = 'option';
                        optionDiv.textContent = option;
                        optionDiv.onclick = () => this.selectOption(index, optionDiv);
                        optionsDiv.appendChild(optionDiv);
                    });
                    
                    container.appendChild(optionsDiv);
                } else if (question.type === 'true_false') {
                    const optionsDiv = document.createElement('div');
                    optionsDiv.className = 'options';
                    
                    ['True', 'False'].forEach((option, index) => {
                        const optionDiv = document.createElement('div');
                        optionDiv.className = 'option';
                        optionDiv.textContent = option;
                        optionDiv.onclick = () => this.selectOption(index === 0, optionDiv);
                        optionsDiv.appendChild(optionDiv);
                    });
                    
                    container.appendChild(optionsDiv);
                } else if (question.type === 'fill_blank') {
                    const input = document.createElement('input');
                    input.type = 'text';
                    input.className = 'input-answer';
                    input.placeholder = 'Enter your answer...';
                    input.value = this.userAnswers[this.currentQuestionIndex] || '';
                    input.oninput = (e) => this.userAnswers[this.currentQuestionIndex] = e.target.value;
                    container.appendChild(input);
                }

                this.restoreSelection();
            }

            selectOption(value, element) {
                element.parentNode.querySelectorAll('.option').forEach(opt => {
                    opt.classList.remove('selected');
                });
                
                element.classList.add('selected');
                this.userAnswers[this.currentQuestionIndex] = value;
            }

            restoreSelection() {
                const userAnswer = this.userAnswers[this.currentQuestionIndex];
                if (userAnswer === null || userAnswer === undefined) return;

                const question = this.questions[this.currentQuestionIndex];
                
                if (question.type === 'multiple_choice') {
                    const options = document.querySelectorAll('.option');
                    if (options[userAnswer]) {
                        options[userAnswer].classList.add('selected');
                    }
                } else if (question.type === 'true_false') {
                    const options = document.querySelectorAll('.option');
                    const index = userAnswer === true ? 0 : 1;
                    if (options[index]) {
                        options[index].classList.add('selected');
                    }
                }
            }

            checkAnswer() {
                const question = this.questions[this.currentQuestionIndex];
                const userAnswer = this.userAnswers[this.currentQuestionIndex];
                
                let isCorrect = false;
                
                if (question.type === 'multiple_choice') {
                    isCorrect = question.options[userAnswer] === question.correct_answer;
                    this.highlightMultipleChoiceAnswer(question, userAnswer);
                } else if (question.type === 'true_false') {
                    isCorrect = userAnswer === question.correct_answer;
                    this.highlightTrueFalseAnswer(question, userAnswer);
                } else if (question.type === 'fill_blank') {
                    isCorrect = userAnswer && userAnswer.toLowerCase().trim() === question.correct_answer.toLowerCase().trim();
                }

                const explanationDiv = document.getElementById('explanation');
                explanationDiv.innerHTML = `
                    <strong>${isCorrect ? '‚úÖ Correct!' : '‚ùå Incorrect'}</strong><br>
                    ${question.explanation || 'No explanation available.'}
                `;
                explanationDiv.style.display = 'block';

                if (this.userAnswers[this.currentQuestionIndex] !== 'checked') {
                    if (isCorrect) this.correctCount++;
                    this.userAnswers[this.currentQuestionIndex] = 'checked';
                }

                this.updateStats();
            }

            highlightMultipleChoiceAnswer(question, userAnswer) {
                const options = document.querySelectorAll('.option');
                const correctIndex = question.options.findIndex(opt => opt === question.correct_answer);
                
                options.forEach((option, index) => {
                    if (index === correctIndex) {
                        option.classList.add('correct');
                    } else if (index === userAnswer && index !== correctIndex) {
                        option.classList.add('incorrect');
                    }
                });
            }

            highlightTrueFalseAnswer(question, userAnswer) {
                const options = document.querySelectorAll('.option');
                const correctIndex = question.correct_answer === true ? 0 : 1;
                const userIndex = userAnswer === true ? 0 : 1;
                
                options[correctIndex].classList.add('correct');
                if (userIndex !== correctIndex) {
                    options[userIndex].classList.add('incorrect');
                }
            }

            previousQuestion() {
                if (this.currentQuestionIndex > 0) {
                    this.currentQuestionIndex--;
                    this.displayQuestion();
                }
            }

            nextQuestion() {
                if (this.currentQuestionIndex < this.questions.length - 1) {
                    this.currentQuestionIndex++;
                    this.displayQuestion();
                } else {
                    this.showResults();
                }
            }

            updateNavigationButtons() {
                document.getElementById('prevQuestion').disabled = this.currentQuestionIndex === 0;
                document.getElementById('nextQuestion').disabled = false;
                
                if (this.currentQuestionIndex === this.questions.length - 1) {
                    document.getElementById('nextQuestion').textContent = 'Finish Quiz';
                } else {
                    document.getElementById('nextQuestion').textContent = 'Next ‚Üí';
                }
            }

            showResults() {
                const percentage = Math.round((this.correctCount / this.questions.length) * 100);
                
                document.getElementById('quizArea').style.display = 'none';
                document.getElementById('resultsScreen').style.display = 'block';
                document.getElementById('finalScore').textContent = `${percentage}%`;
                
                let resultText = '';
                if (percentage >= 90) {
                    resultText = 'Excellent! You\'ve mastered this material!';
                } else if (percentage >= 80) {
                    resultText = 'Great job! You have a solid understanding.';
                } else if (percentage >= 70) {
                    resultText = 'Good work! Review the areas you missed.';
                } else {
                    resultText = 'Keep studying! Practice makes perfect.';
                }
                
                document.getElementById('resultsText').textContent = resultText;
                this.updateStats();
            }

            restartCurrentQuiz() {
                this.currentQuestionIndex = 0;
                this.userAnswers = new Array(this.questions.length).fill(null);
                this.correctCount = 0;

                // Shuffle questions again
                this.shuffleArray(this.questions);

                document.getElementById('resultsScreen').style.display = 'none';
                document.getElementById('quizArea').style.display = 'block';

                this.displayQuestion();
                this.updateStats();
            }

            showCourseSelection() {
                this.quizStarted = false;
                this.selectedCourse = null;
                this.selectedModules = [];
                this.questions = [];
                this.userAnswers = [];
                this.correctCount = 0;

                document.getElementById('moduleSelection').style.display = 'none';
                document.getElementById('quizArea').style.display = 'none';
                document.getElementById('resultsScreen').style.display = 'none';
                document.getElementById('courseSelection').style.display = 'block';

                // Clear course selection
                document.querySelectorAll('.course-card').forEach(card => {
                    card.classList.remove('selected');
                });
                document.getElementById('selectCourseBtn').disabled = true;

                this.updateStats();
            }

            updateStats() {
                document.getElementById('totalQuestions').textContent = this.questions.length;
                document.getElementById('currentQuestion').textContent = this.quizStarted ? this.currentQuestionIndex + 1 : 0;
                document.getElementById('correctAnswers').textContent = this.correctCount;
                
                const percentage = this.questions.length > 0 ? 
                    Math.round((this.correctCount / this.questions.length) * 100) : 0;
                document.getElementById('scorePercentage').textContent = `${percentage}%`;
            }
        }

        // Initialize the quiz application
        new QuizApp();
    </script>
</body>
</html>